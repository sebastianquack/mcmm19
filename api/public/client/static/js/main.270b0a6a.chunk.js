(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e,t,n){e.exports=n(93)},55:function(e,t,n){},79:function(e){e.exports=[{elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#aaaaaa"},{visibility:"on"},{weight:.5}]},{featureType:"landscape.natural.landcover",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#fefefe"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#cccccc"},{visibility:"on"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#cccccc"},{visibility:"on"},{weight:1}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{visibility:"on"},{weight:.5}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",stylers:[{visibility:"off"}]}]},93:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(16),o=n.n(a),s=(n(55),n(2)),l=n(13),c=n.n(l),u=n(14),p=n(3),h=n(4),m=n(6),f=n(5),d=n(10),y=n(7),g=(n(57),n(1)),b=n(38),v=n(46),O="/api",k={start:1950,end:(new Date).getFullYear()},j=function(e,t){return e>600&&t>400};function w(e,t,n){for(var r=0;r<e.length;r++)if(e[r].key==t){var i=e[r]["content_"+n];return i||"["+t+"]"}return"["+t+"]"}function F(e){return e.replace?e.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()}):""}function x(e){var t=.8*e;return t>5&&(t=5),t<1&&(t=1),t}function E(){var e=Object(s.a)(["\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  width: 30px;\n  height: 30px;\n  &:hover {cursor: pointer};\n"]);return E=function(){return e},e}function I(){var e=Object(s.a)(["\n  background-color: ",";\n  position: ",";;\n  z-index: 10;\n  min-height: 60px;\n  padding: 1.25rem;\n  padding-right: calc(30px + 1rem);\n  border-bottom: ",";\n  display: flex;\n  font-size: 1.25rem;\n  width: 100%;\n"]);return I=function(){return e},e}var S=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.a.createElement(C,{menuOpen:this.props.menuOpen},this.props.children,i.a.createElement(_,{src:"/images/close.png",onClick:this.props.onClose}))}}]),t}(r.Component),C=g.b.div(I(),function(e){return e.menuOpen?"none":"white"},function(e){return e.menuOpen?"relative":"absolute"},function(e){return e.menuOpen?"border: none":"1px solid #ddd"}),_=g.b.img(E());function T(){var e=Object(s.a)(["\n  padding: 1.25rem;\n  font-size: 1.25rem;\n"]);return T=function(){return e},e}function M(){var e=Object(s.a)(["\n  flex:1;\n  padding-top: 0rem; // height of the top bar, ~4rem\n  overflow-y: auto;\n"]);return M=function(){return e},e}function z(){var e=Object(s.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  opacity: 0.5;\n  z-index: 300;\n  display: ",";\n"]);return z=function(){return e},e}function D(){var e=Object(s.a)(["\n  width: 50%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  visibility: ",";\n  z-index: 300;\n\n  display: flex;\n  flex-direction: column;\n  background-color: white;\n\n  @media only screen and (max-width: 768px) {\n    width: 100%;\n  }\n"]);return D=function(){return e},e}function L(){var e=Object(s.a)(["\n  margin-bottom: 0.625rem;\n  &:hover {cursor: pointer};\n"]);return L=function(){return e},e}function W(){var e=Object(s.a)(['\n  text-decoration: none;\n  list-style: none;\n  font-size: 16px;\n  font-family: "NeutraTextLight";\n  span { \n    font-family: ',"; \n    padding: 5px;\n  }\n  :hover {cursor: ",'};\n  :first-child {:after { content: "/" }};\n  display: inline-block;\n']);return W=function(){return e},e}function U(){var e=Object(s.a)(["\n  margin-left: 0px;\n  padding-left: 0px;\n  margin-top: 40px;\n"]);return U=function(){return e},e}n(25);var N=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=["en","de"].map(function(t){return i.a.createElement(Y,{key:t,active:t==e.props.locale,onClick:function(){return e.props.setLocale(t)}},i.a.createElement("span",null,t))});return i.a.createElement("div",null,i.a.createElement(P,null,t))}}]),t}(r.Component),P=g.b.ul(U()),Y=g.b.li(W(),function(e){return e.active?"NeutraText":"NeutraTextLight"},function(e){return e.active?"default":"pointer"}),R=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.render&&this.props.render.props.titleKey?w(this.props.translations,this.props.render.props.titleKey,this.props.locale):w(this.props.translations,"menu",this.props.locale);return[i.a.createElement(A,{onClick:this.props.close,menuOpen:this.props.menuOpen}),i.a.createElement(B,{menuOpen:this.props.menuOpen},i.a.createElement(S,{onClose:this.props.close,menuOpen:this.props.menuOpen},t),this.props.render?i.a.createElement(J,null,this.props.render):i.a.createElement(J,null,i.a.createElement(H,null,i.a.createElement(K,{onClick:this.props.reset},w(this.props.translations,"home",this.props.locale)),i.a.createElement(K,{onClick:function(){return e.props.navigate("page","programm")}},w(this.props.translations,"programm",this.props.locale)),i.a.createElement(K,{onClick:function(){return e.props.navigate("page","howto")}},w(this.props.translations,"howto",this.props.locale)),!this.props.projectionMode&&i.a.createElement(K,{onClick:function(){return e.props.navigate("list")}},w(this.props.translations,"my_entries",this.props.locale)),!this.props.projectionMode&&i.a.createElement(K,{onClick:function(){return e.props.navigate("scan")}},w(this.props.translations,"scanner",this.props.locale)),i.a.createElement(K,{onClick:function(){return e.props.navigate("page","credits")}},w(this.props.translations,"credits",this.props.locale)),i.a.createElement(N,{locale:this.props.locale,setLocale:this.props.setLocale,translations:this.props.translations}))))]}}]),t}(r.Component),K=g.b.li(L()),B=g.b.div(D(),function(e){return e.menuOpen?"visibile":"hidden"}),A=g.b.div(z(),function(e){return e.menuOpen?"block":"none"}),J=g.b.div(M()),H=g.b.ul(T()),V=n(8),q=n.n(V),X=n(41);function Z(){var e=Object(s.a)(["\n  \n\n"]);return Z=function(){return e},e}function $(){var e=Object(s.a)(['\n  width: 100%; \n  height: 100%;\n  /*background-image: url("/images/background5.png");\n  background-size: cover;*/\n  visibility: ',";\n"]);return $=function(){return e},e}function G(){var e=Object(s.a)(["\n  font-family: NeutraText;\n  :hover {\n    text-decoration: underline;\n    cursor: pointer;\n  }\n"]);return G=function(){return e},e}function Q(){var e=Object(s.a)(["\n  margin-top: 1rem;\n  margin-bottom: ",";\n  float: right;\n  font-size: 1rem;\n  display: block;\n  :hover {\n    text-decoration: underline;\n    cursor: pointer;\n  }\n"]);return Q=function(){return e},e}function ee(){var e=Object(s.a)(["\n  display: block;\n  font-size: 1rem;\n  :hover {\n    text-decoration: underline;\n    cursor: pointer;\n  }\n"]);return ee=function(){return e},e}function te(){var e=Object(s.a)(["\n  font-family: NeutraTextLightItalic;\n  font-size: 1.7rem;\n  margin-bottom: 0.5rem;\n  margin-top: 0.5rem;\n"]);return te=function(){return e},e}function ne(){var e=Object(s.a)(["\n  margin-bottom: 0.5rem;\n"]);return ne=function(){return e},e}function re(){var e=Object(s.a)(["\n"]);return re=function(){return e},e}function ie(){var e=Object(s.a)(["\n  position: absolute;\n  right: 20px;\n  top: 20px;\n  width: 20px;\n  height: 20px;\n  :hover {\n    cursor: pointer;\n  };\n"]);return ie=function(){return e},e}function ae(){var e=Object(s.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  \n  width: ",";\n  \n  background-color: #000;\n  color: #fff;\n  padding: 25px;\n  font-family: NeutraTextDemi;\n  font-size: 1.2rem;\n  max-height: 100%;\n  overflow-y: scroll;\n  z-index: 200;\n"]);return ae=function(){return e},e}function oe(){var e=Object(s.a)(["\n  font-family: NeutraText;\n"]);return oe=function(){return e},e}var se=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).nextEntry=function(){n.state.entryIndex<n.props.entries.length-1?n.setState({entryIndex:n.state.entryIndex+1}):n.setState({entryIndex:0})},n.state={entryIndex:0},n.nextEntry=n.nextEntry.bind(Object(d.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.entries.map(function(t,n){return i.a.createElement(pe,null,i.a.createElement(ue,{onClick:e.props.close,src:"/images/closeWhite.png"}),i.a.createElement(he,null,i.a.createElement(le,null,F(t.city))," ",e.state.entryIndex+1,"/",e.props.entries.length),i.a.createElement("p",null,i.a.createElement(le,null,t.year)," ",i.a.createElement(ye,{onClick:function(){e.props.setMusicianFilter(t.musician)}},">\xa0",F(t.musician))),i.a.createElement(me,null,t.note?'"'+t.note+'"':w(e.props.translations,"ohne_worte",e.props.locale)),i.a.createElement(fe,{onClick:function(){e.props.setUserFilter([t.user_id])}},w(e.props.translations,"zur_bio",e.props.locale)),e.props.entries.length>1&&i.a.createElement(de,{largeScreen:e.props.largeScreen,onClick:function(t){t.stopPropagation(),e.nextEntry()}},w(e.props.translations,"next_entry",e.props.locale)))});return i.a.createElement(ce,{largeScreen:this.props.largeScreen},t[this.state.entryIndex])}}]),t}(r.Component),le=g.b.span(oe()),ce=g.b.div(ae(),function(e){return e.largeScreen?"50%":"100%"}),ue=g.b.img(ie()),pe=g.b.div(re()),he=g.b.p(ne()),me=g.b.div(te()),fe=g.b.span(ee()),de=g.b.span(Q(),function(e){return e.largeScreen?"0rem":"1rem"}),ye=g.b.span(G()),ge=n(79),be=window.google,ve=window.MarkerClusterer,Oe=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).mapContainerRef=i.a.createRef(),n.infoWindowRef=i.a.createRef(),n.markers=[],n.lines=[],n.fetchData=n.fetchData.bind(Object(d.a)(n)),n.drawMap=n.drawMap.bind(Object(d.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"fetchData",value:function(){var e=this,t={};this.props.musicianFilter&&(t.musician=this.props.musicianFilter),this.props.userFilter&&this.props.userFilter.length>0&&(t.userIds=JSON.stringify(this.props.userFilter)),this.props.yearFilter&&(t.year=this.props.yearFilter),q.a.get(O+"/map_entries/",{params:t}).then(function(t){console.log(t),e.setState({entries:t.data},e.drawMap)}).catch(function(e){console.log(e)})}},{key:"componentDidMount",value:function(){this.fetchData(),this.map=new be.maps.Map(this.mapContainerRef.current,{zoom:4,center:{lat:0,lng:0},streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1,maxZoom:10,zoomControl:!1,styles:ge,backgroundColor:"hsla(0, 0%, 0%, 0)"})}},{key:"componentDidUpdate",value:function(e){this.props.musicianFilter===e.musicianFilter&&this.props.userFilter===e.userFilter&&this.props.yearFilter===e.yearFilter||(console.log("componentDidUpdate"),this.markerCluster&&this.markerCluster.clearMarkers(),this.markers.forEach(function(e){e.setMap(null)}),this.markers=[],this.entries=[],this.fetchData())}},{key:"drawMap",value:function(){var e=this,t=this.props.musicianFilter||this.props.userFilter&&this.props.userFilter.length>0||this.props.yearFilter,n={url:"/images/marker.svg",scaledSize:{height:30,width:30},origin:{x:0,y:0},anchor:{x:12.5,y:12.5}},r=function(e){var t=15*e;return Object(X.a)({},n,{labelOrigin:new be.maps.Point(12.5,t+10),scaledSize:{height:t,width:t},anchor:{x:t/2,y:t/2}})},i=new window.google.maps.LatLngBounds;Object.keys(this.state.entries).forEach(function(n){var a=e.state.entries[n][0],o=!1;e.markers.forEach(function(t,i){a.cityLocation.lat==t.position.lat()&&a.cityLocation.lng==t.position.lng()&&(t.entries=t.entries.concat(e.state.entries[n]),o=!0,t.setIcon(r(x(t.entries.length))),console.log("duplicateLocation"))});var s=e.state.entries[n].map(function(e){return F(e.musician)}).join(", "),l=e.state.entries[n].length;if(!o){var c=new be.maps.Marker({position:a.cityLocation,icon:r(x(l)),label:t?{color:"#000",fontSize:"1rem",fontFamily:"NeutraTextDemi",text:s}:void 0});c.entries=e.state.entries[n],c.addListener("click",function(){e.props.setInfoWindow(c.entries)}),e.markers.push(c),i.extend(a.cityLocation)}}),this.map.fitBounds(i);var a=be.maps.event.addListener(this.map,"idle",function(n){if(be.maps.event.removeListener(a),console.log("filterOn",e.props.filterOn),e.props.filterOn?e.markers.forEach(function(t){t.setMap(e.map)}):e.markerCluster=new ve(e.map,e.markers,{gridSize:60,minimumClusterSize:2,styles:[{fontFamily:"NeutraTextDemi",textColor:"white",textSize:16,url:"/images/star_group.svg",height:50,width:50}]}),be.maps.event.addListener(e.map,"click",function(t){e.props.setInfoWindow(null)}),e.lines.forEach(function(e){return e.setMap(null)}),e.lines=[],t){var r={};Object.keys(e.state.entries).forEach(function(t){e.state.entries[t].forEach(function(e){r[e.user_id]||(r[e.user_id]=[]),r[e.user_id].push({location:e.cityLocation,year:e.year})})}),console.log(r),Object.keys(r).forEach(function(t){var n=r[t];n.sort(function(e,t){return t.year-e.year});var i=n.map(function(e){return{lat:e.location.lat,lng:e.location.lng}});e.lines.push(new be.maps.Polyline({path:i,strokeColor:"#000",strokeOpacity:.5,strokeWeight:1}))}),e.lines.forEach(function(t){return t.setMap(e.map)})}})}},{key:"render",value:function(){var e=this;return[i.a.createElement(ke,{ref:this.mapContainerRef}),i.a.createElement(je,null,this.props.showInfoWindow&&i.a.createElement(se,{entries:this.props.showInfoWindow,setUserFilter:this.props.setUserFilter,translations:this.props.translations,locale:this.props.locale,close:function(){return e.props.setInfoWindow(null)},largeScreen:this.props.largeScreen,setMusicianFilter:this.props.setMusicianFilter}))]}}]),t}(r.Component),ke=g.b.div($(),function(e){return 0!=e.visible?"visible":"hidden"}),je=g.b.div(Z());function we(){var e=Object(s.a)(["\n  display: inline-block;\n  background-image: url(/images/dot.png);\n  width: 20px;\n  height: 20px;\n  background-repeat: no-repeat;\n  background-size: contain;\n  color: #fff;\n  font-size: 12px;\n  text-align: center;\n  line-height: 20px;\n"]);return we=function(){return e},e}function Fe(){var e=Object(s.a)(["\n  list-style: none;\n  margin-bottom: 0.3125rem;\n  border-bottom: 1px dashed black;\n  padding-bottom: 0.3125rem;\n  font-family: NeutraText;\n\n"]);return Fe=function(){return e},e}function xe(){var e=Object(s.a)(["\n  padding-left: 0px;\n  font-size: 1.25rem;\n  margin-bottom: 1.25rem;\n"]);return xe=function(){return e},e}function Ee(){var e=Object(s.a)(["\n  color: #000;\n  text-decoration: none;\n  :visited {\n    color: #000;\n  };\n  :hover {\n    text-decoration: underline;\n  };\n"]);return Ee=function(){return e},e}function Ie(){var e=Object(s.a)(["\n  :hover {\n    cursor: pointer;\n    text-decoration: underline;\n  };\n"]);return Ie=function(){return e},e}function Se(){var e=Object(s.a)(["\n  padding: 1.25rem;\n  font-family: NeutraTextDemi;\n"]);return Se=function(){return e},e}function Ce(){var e=Object(s.a)(["\n  font-family: NeutraTextDemi;\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n  :hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n"]);return Ce=function(){return e},e}function _e(){var e=Object(s.a)(["\n  font-family: NeutraTextDemi;\n  margin-top: 1rem;\n  :hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n"]);return _e=function(){return e},e}var Te=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={entries:[]},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.hash=this.props.mcmmId,q.a.get(O+"/entry_by_user/"+this.props.mcmmId+"/").then(function(e){t.setState({entries:e.data.docs})}).catch(function(e){console.log(e)});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.entries.map(function(t,n){return i.a.createElement(Ne,{key:n},i.a.createElement(Le,{onClick:function(){e.props.editEntry(t)}},t.year,", ",F(t.musician)," in ",F(t.city)))});return i.a.createElement(De,null,i.a.createElement(Ue,null,t),i.a.createElement("p",null,i.a.createElement(ze,{onClick:function(){return e.props.navigate("edit")}},w(this.props.translations,"new_entry",this.props.locale))),i.a.createElement("p",null,w(this.props.translations,"edit_link_info_1",this.props.locale),i.a.createElement("br",null),i.a.createElement(We,{href:"#"+this.props.mcmmId},window.location.href)),i.a.createElement("p",null,w(this.props.translations,"edit_link_info_2",this.props.locale)),i.a.createElement(Me,{onClick:function(){e.props.setUserFilter([e.props.mcmmId])}},w(this.props.translations,"show_my_entries",this.props.locale)))}}]),t}(r.Component),Me=g.b.div(_e()),ze=g.b.div(Ce()),De=g.b.div(Se()),Le=g.b.span(Ie()),We=g.b.a(Ee()),Ue=g.b.ul(xe()),Ne=g.b.li(Fe()),Pe=(g.b.span(we()),n(22));function Ye(){var e=Object(s.a)(['\n  position: fixed;\n  bottom:0;\n  left:0;\n  right: 0;\n  padding: 1rem;\n  box-sizing: border-box;\n  line-height: 1;\n\n  display: flex;\n  width: 100%;\n\n  li {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    height: 6em;\n  }\n\n  li .year_top {\n    height: 3vh;\n    /* background: red; */\n  }\n\n  li .year_top img {\n    left: 50%;\n    width: auto;\n    height: 1vh;\n    transform-origin: center 67%;\n    \n    /* background: yellow; */\n  }\n\n  li .year_middle {\n    height: 3vh;\n  }\n\n  li .year_middle:before {\n    content: "";\n    border: solid 1px black;\n    border-width: 0 0 0 1px;\n    position: relative;\n    left: calc(50% - 1px);\n  }\n\n  li .year_bottom {\n    height: 3vh;\n    /* background: green; */\n  }\n\n  li .year_bottom span {\n    width: calc(1em + 20%);\n    transform: rotate(-90deg) translateX(-100%);\n    overflow: visible;\n    /* background: red; */\n  }\n\n  li > * {\n    position: relative;\n  }\n\n  li > * > * {\n    position: absolute;\n  }\n']);return Ye=function(){return e},e}function Re(){var e=Object(s.a)(["\n  :hover { \n    cursor: pointer \n    text-decoration: underline;\n  };\n"]);return Re=function(){return e},e}var Ke=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={data:[]},n.fetchData=n.fetchData.bind(Object(d.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"fetchData",value:function(){var e=this,t={};this.props.musicianFilter&&(t.musician=this.props.musicianFilter),this.props.yearFilter&&(t.year=this.props.yearFilter),this.props.userFilter&&this.props.userFilter.length>0&&(t.userIds=JSON.stringify(this.props.userFilter)),q.a.get(O+"/year_data/",{params:t}).then(function(t){e.setState({data:t.data})}).catch(function(e){console.log(e)})}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){this.props.musicianFilter===e.musicianFilter&&this.props.userFilter===e.userFilter&&this.props.yearFilter===e.yearFilter||this.fetchData()}},{key:"renderYear",value:function(e,t){var n=this;return i.a.createElement("li",{key:e},i.a.createElement("span",{className:"year_top"},t>0?i.a.createElement("img",{style:{transform:"translateX(-50%) scale("+x(t)+")"},alt:e,src:"/images/marker.svg"}):null),i.a.createElement("span",{className:"year_middle"}),i.a.createElement("span",{className:"year_bottom"},i.a.createElement(Be,{onClick:function(){n.props.setYearFilter(e)}},t>0?e:null)))}},{key:"render",value:function(){var e=this,t=this.state.data;if(!t||0===t.length)return null;var n=t[0].year-k.start;n>0&&t.unshift.apply(t,Object(Pe.a)(Array.from(Array(n),function(e,r){return{year:r+(t[0].year-n),amount:0}})));var r=k.end-t[t.length-1].year;r>0&&t.push.apply(t,Object(Pe.a)(Array.from(Array(r),function(e,n){return{year:n+(t[t.length-1].year+r),amount:0}})));var a=t[0].year,o=t.map(function(t){return e.renderYear(t.year,t.amount)});return i.a.createElement(Ae,{start:a},o)}}]),t}(r.PureComponent),Be=g.b.span(Re()),Ae=g.b.ol(Ye());function Je(){var e=Object(s.a)(["\n  &:hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n"]);return Je=function(){return e},e}function He(){var e=Object(s.a)(["\n  position: fixed;\n  right: 0;\n  top: ",";\n  width: auto;\n  padding: 1rem 1rem 0 0;\n  box-sizing: border-box;\n\n  ul {\n    list-style-type: none;\n  } ;\n  li {\n    display: flex;\n    span:first-child {\n      width: 2em;\n      margin-right: 0.75em;\n    }\n    span:last-child {\n      flex: 1;\n      &:hover {\n        cursor: pointer;\n        text-decoration: underline;\n      }\n    }\n  }\n"]);return He=function(){return e},e}var Ve=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={musicians:[]},n.fetchData=n.fetchData.bind(Object(d.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t={};this.props.musicianFilter&&(t.musician=this.props.musicianFilter),this.props.userFilter&&this.props.userFilter.length>0&&(t.userIds=JSON.stringify(this.props.userFilter)),this.props.yearFilter&&(t.year=this.props.yearFilter),q.a.get(O+"/top_musicians/10/",{params:t}).then(function(t){e.setState({musicians:t.data})}).catch(function(e){console.log(e)})}},{key:"componentDidUpdate",value:function(e){this.props.musicianFilter===e.musicianFilter&&this.props.userFilter===e.userFilter&&this.props.yearFilter===e.yearFilter||this.fetchData()}},{key:"render",value:function(){var e=this,t=this.state.musicians.sort(function(e,t){return e.percent<t.percent?1:-1}).map(function(t,n){return i.a.createElement("li",{key:n,onClick:function(){return e.props.setMusicianFilter(t.name)}},i.a.createElement("span",null,t.percent,"%"),i.a.createElement("span",null,F(t.name),"\xa0(",t.count,")"))});return i.a.createElement(qe,{filterOn:this.props.filterOn},i.a.createElement("ul",null,t))}}]),t}(r.Component),qe=g.b.div(He(),function(e){return e.filterOn?"60px":"0"});g.b.span(Je());function Xe(){var e=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n"]);return Xe=function(){return e},e}var Ze=function(e){function t(e){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).call(this,e))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.userFilter.length>0||this.props.musicianFilter||this.props.yearFilter;return i.a.createElement($e,null,i.a.createElement(Oe,{userFilter:this.props.userFilter,setUserFilter:this.props.setUserFilter,musicianFilter:this.props.musicianFilter,yearFilter:this.props.yearFilter,translations:this.props.translations,locale:this.props.locale,largeScreen:this.props.largeScreen,setInfoWindow:this.props.setInfoWindow,showInfoWindow:this.props.showInfoWindow,setMusicianFilter:this.props.setMusicianFilter,filterOn:e}),this.props.largeScreen&&i.a.createElement(Ve,{musicianFilter:this.props.musicianFilter,userFilter:this.props.userFilter,setMusicianFilter:this.props.setMusicianFilter,yearFilter:this.props.yearFilter,filterOn:e}),this.props.largeScreen&&i.a.createElement(Ke,{musicianFilter:this.props.musicianFilter,yearFilter:this.props.yearFilter,setYearFilter:this.props.setYearFilter,userFilter:this.props.userFilter}))}}]),t}(r.Component),$e=g.b.div(Xe()),Ge=n(12),Qe=n(21),et=n.n(Qe);function tt(){var e=Object(s.a)(["\n  width: 100%;\n  margin-top: 20px;\n  :hover {cursor: pointer};\n  text-align: center;\n"]);return tt=function(){return e},e}function nt(){var e=Object(s.a)(['\n  input, textarea {\n    display: block;\n    border:none;\n    width: 100%;\n    background-color: black;\n    color: white;\n    outline: none;\n    box-sizing: border-box;\n    padding: 0.5rem;\n  }\n\n  input {\n    font-size: 200%;\n    text-align: left;\n    height: 2em;\n    &[name="year"] {\n      width: auto;\n    }\n  }\n\n  textarea {\n    height: 100px;\n    font-size: 150%;\n    font-family: NeutraTextLightItalic;\n  }\n\n  margin-bottom: 2rem;\n']);return nt=function(){return e},e}function rt(){var e=Object(s.a)(["\n  display: inline-block;\n  width: 100%;\n  margin-top: 10px;\n  margin-bottom: 5px;\n"]);return rt=function(){return e},e}function it(){var e=Object(s.a)(["\n  padding: 1.25rem;\n"]);return it=function(){return e},e}var at=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).handleSubmit=function(e){n.state.musician&&n.state.city&&n.state.year&&(console.log(n.state),n.setState({processing:!0}),n.state._id?q.a.put(O+"/entry/"+n.state._id,{musician:n.state.musician,city:n.state.city,year:parseInt(n.state.year),note:n.state.note,user_id:n.props.mcmmId}).then(function(e){console.log(e),n.setState({_id:e.data._id,changed:!1,processing:!1})}).catch(function(e){console.log(e)}):q.a.post(O+"/entry",{musician:n.state.musician,city:n.state.city,year:parseInt(n.state.year),note:n.state.note,user_id:n.props.mcmmId}).then(function(e){console.log(e),n.setState({_id:e.data._id,changed:!1,processing:!1})}).catch(function(e){console.log(e)}))},n.handleDelete=function(){window.confirm("really?")&&(n.setState({processing:!0}),q.a.delete(O+"/entry/"+n.state._id,{}).then(function(e){console.log(e),n.props.back()}).catch(function(e){console.log(e)}))},n.handleInputChange=function(e){var t,r=e.target,i=r.name,a="year"!==i||"year"===i&&!isNaN(r.value)?r.value:n.state.year;n.setState((t={},Object(Ge.a)(t,i,a),Object(Ge.a)(t,"changed",!0),t))},n.fixYear=function(e){var t=k.end,n=k.start;return e<n&&""!==e&&(e=n),e>t&&(e=t),e},n.state={musician:n.props.entry?n.props.entry.musician:"",city:n.props.entry?n.props.entry.city:"",year:n.props.entry?n.props.entry.year:"",note:n.props.entry?n.props.entry.note:"",_id:n.props.entry?n.props.entry._id:null,musicians:[],cities:[],changed:!1,processing:!1},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:q.a.get(O+"/entry_uniques/").then(function(e){console.log(e),t.setState({musicians:e.data.musicians}),t.setState({cities:e.data.cities})}).catch(function(e){console.log(e)});case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return i.a.createElement(ot,null,i.a.createElement(ct,null,i.a.createElement(st,null,w(this.props.translations,"note_prompt",this.props.locale)),i.a.createElement("textarea",{name:"note",maxlength:"200",value:this.state.note,onChange:this.handleInputChange}),i.a.createElement("br",null),i.a.createElement(st,null,w(this.props.translations,"musician_prompt",this.props.locale)),i.a.createElement(et.a,{items:this.state.musicians.map(function(e){return{value:F(e)}}),getItemValue:function(e){return e.value},shouldItemRender:function(e,t){return e.value.toLowerCase().indexOf(t.toLowerCase())>-1},renderItem:function(e,t){return i.a.createElement("div",{key:e.value,style:{backgroundColor:t?"#eee":"transparent"}},e.value)},value:F(this.state.musician),onChange:function(t){return e.setState({musician:t.target.value,changed:!0})},onSelect:function(t){return e.setState({musician:t,changed:!0})},wrapperStyle:{display:"block"},inputProps:{style:lt}}),i.a.createElement("br",null),i.a.createElement(st,null,w(this.props.translations,"city_prompt",this.props.locale)),i.a.createElement(et.a,{items:this.state.cities.map(function(e){return{value:F(e)}}),getItemValue:function(e){return e.value},shouldItemRender:function(e,t){return e.value.toLowerCase().indexOf(t.toLowerCase())>-1},renderItem:function(e,t){return i.a.createElement("div",{key:e.value,style:{backgroundColor:t?"#eee":"transparent"}},e.value)},value:F(this.state.city),onChange:function(t){return e.setState({city:t.target.value,changed:!0})},onSelect:function(t){return e.setState({city:t,changed:!0})},wrapperStyle:{display:"block",opacity:1},inputProps:{style:lt}}),i.a.createElement("br",null),i.a.createElement(st,null,w(this.props.translations,"year_prompt",this.props.locale)),i.a.createElement("input",{autoComplete:"off",size:"4",maxLength:"4",type:"text",name:"year",value:this.state.year,onChange:this.handleInputChange,onBlur:function(){return e.setState({year:e.fixYear(e.state.year)})}}),i.a.createElement("br",null),this.state.processing?i.a.createElement("span",null,w(this.props.translations,"...",this.props.locale)):i.a.createElement("div",null,this.state.changed&&i.a.createElement(ut,{onClick:this.handleSubmit},w(this.props.translations,"save_entry",this.props.locale)),this.state._id&&i.a.createElement(ut,{onClick:this.handleDelete},w(this.props.translations,"delete_entry",this.props.locale)))))}}]),t}(r.Component),ot=g.b.div(it()),st=g.b.label(rt()),lt={},ct=g.b.form(nt()),ut=g.b.div(tt()),pt=n(42),ht=n.n(pt);function mt(){var e=Object(s.a)(["\n  height: calc(((100vh - ",") / 100vh) * 100vw);\n  max-width:calc(50vh - 0.5 * ",");\n  max-height:calc(50vh - 0.5 * ",");\n  width: 100vw;\n  position: relative;\n  background-color: black;\n  border: 1px solid white;\n\n  > p {\n    position: absolute;\n    width: 100%;\n    color: white;\n    bottom: 0.5rem;\n    opacity: 0.5;\n    z-index: 10;\n    text-align: center;\n  }\n"]);return mt=function(){return e},e}function ft(){var e=Object(s.a)(["\n  flex: 1;\n  max-width:calc(50vh - 0.5 * ",");\n  width: 100vw;  \n  padding: 2.5rem;\n  display: flex;\n  justify-content: flex-start;\n  flex-direction: column;\n  background-color: white;\n  border: 1px solid black;\n\n  canvas {\n    width:100% !important;\n    height: auto !important;\n  }\n\n"]);return ft=function(){return e},e}function dt(){var e=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  height: calc(100vh - ",");\n  align-items: center;\n  background-color: black;\n"]);return dt=function(){return e},e}var yt=n(87),gt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).handleScan=function(e){e&&(n.setState({result:e}),"pro_"==e.substring(0,4)?n.props.setUserFilter([n.props.mcmmId]):n.props.setUserFilter([n.props.mcmmId,e]),q.a.get(O+"/set_filter/"+e+"/"+n.props.mcmmId).then(function(e){console.log(e)}).catch(function(e){console.log(e)}))},n.handleError=function(e){console.error(e)},n.state={result:"Scanning..."},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.pollInterval=setInterval(function(){e.props.pollFilter(e.props.mcmmId)},5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.pollInterval)}},{key:"render",value:function(){return i.a.createElement(bt,null,i.a.createElement(vt,null,i.a.createElement(yt,{value:this.props.mcmmId,size:500})),i.a.createElement(Ot,null,i.a.createElement(ht.a,{delay:300,onError:this.handleError,onScan:this.handleScan}),i.a.createElement("p",null,this.state.result)))}}]),t}(r.Component),bt=g.b.div(dt(),"4rem"),vt=g.b.div(ft(),"4rem"),Ot=g.b.div(mt(),"4rem","4rem","4rem");function kt(){var e=Object(s.a)(["\n  padding: 1.25rem;\n  font-family: NeutraTextDemi;\n  p {\n    margin-bottom: 1rem;\n  }\n  h2 {\n    font-family: NeutraText;\n    margin-bottom: 1rem;\n  }\n  a {\n    color: #000;\n    :visited {\n      color: #000;\n    }\n    text-decoration: none;\n    :hover {\n      text-decoration: underline;\n    }\n  }\n"]);return kt=function(){return e},e}var jt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.a.createElement(wt,null,i.a.createElement("div",{dangerouslySetInnerHTML:{__html:w(this.props.translations,this.props.pageKey+"_content",this.props.locale)}}))}}]),t}(r.Component),wt=g.b.div(kt()),Ft=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<200;t++)e.push(i.a.createElement("circle",{cx:"66%",cy:"-100",r:7*t,stroke:"#ddd",strokeWidth:"1",fill:"none"}));return i.a.createElement("svg",{style:{position:"absolute"},height:"100%",width:"100%"},e)}}]),t}(r.Component);function xt(){var e=Object(s.a)(["\n"]);return xt=function(){return e},e}function Et(){var e=Object(s.a)(["\n  position: fixed;\n  z-index: 100;\n  right: 1rem;\n  bottom: ",";\n  width: 3rem;\n  height: 3rem;\n  font-size: 4rem;\n  line-height: 1.2rem;\n  font-family: NeutraTextLight;\n  text-align: center;\n  border: 2px solid black;\n  border-radius: 50%;\n  background-color: white;\n  padding: 10px;\n  &:hover {cursor: pointer}; \n"]);return Et=function(){return e},e}function It(){var e=Object(s.a)(["\n  height: 100%;\n  width: 100%;\n  background: #fff;\n"]);return It=function(){return e},e}function St(){var e=Object(s.a)(["\n  width: auto;\n  height: calc(2 * 1.25rem); // scaling factor for the png image * font-size\n  &:hover {cursor: pointer}; \n"]);return St=function(){return e},e}function Ct(){var e=Object(s.a)(["\n  font-size: 2.5rem;\n  padding-left: 1rem;\n  letter-spacing: 0.2ex;\n"]);return Ct=function(){return e},e}function _t(){var e=Object(s.a)(["\n  position: fixed;\n  top:0;\n  z-index: 100;\n  display: flex;\n  padding: 1rem;\n"]);return _t=function(){return e},e}var Tt=n(25),Mt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).onResize=function(e,t){n.setState({largeScreen:j(e,t)})},n.setLocale=function(e){n.setState({locale:e})},n.toggleMenu=function(){if(n.state.menuOpen){if("edit"==n.state.currentPage)return void n.back();n.navigate("home")}n.setState({menuOpen:!n.state.menuOpen})},n.navigate=function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){var r=n.state.navStack;r.push(n.state.currentPage),n.setState({navStack:r})}if(n.setState({menuOpen:"home"!==e,currentPage:e,currentEntry:t,pageKey:t,showInfoWindow:null}),"list"!=e){var i=window.location.pathname+(n.state.projectionId?"?projection_id="+n.state.projectionId:"");window.history.pushState("",document.title,i)}},n.reset=function(){n.setUserFilter([]),n.navigate("home")},n.back=function(){if("scan"!=n.state.currentPage){var e=n.state.navStack,t=e.pop();n.setState({navStack:e}),n.navigate(t,n.state.entry,!0)}else n.navigate("home")},n.state={examples:[],menuOpen:!1,currentPage:"home",mcmmId:null,navStack:[],userFilter:[],musicianFilter:null,yearFilter:null,showInfoWindow:null,translations:[],locale:"de",projectionId:null},n.setUserFilter=n.setUserFilter.bind(Object(d.a)(n)),n.setMusicianFilter=n.setMusicianFilter.bind(Object(d.a)(n)),n.setYearFilter=n.setYearFilter.bind(Object(d.a)(n)),n.setLocale=n.setLocale.bind(Object(d.a)(n)),n.pollFilter=n.pollFilter.bind(Object(d.a)(n)),n.handleFilterClose=n.handleFilterClose.bind(Object(d.a)(n)),n.setInfoWindow=n.setInfoWindow.bind(Object(d.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"setUserFilter",value:function(e){var t=this;this.setState({userFilter:e,musicianFilter:null,yearFilter:null,showInfoWindow:null},function(){"home"!=t.state.currentPage&&t.navigate("home")})}},{key:"setMusicianFilter",value:function(e){console.log("setMusicianFilter",e),this.setState({musicianFilter:e,userFilter:[],yearFilter:null,showInfoWindow:null})}},{key:"setYearFilter",value:function(e){this.setState({musicianFilter:null,userFilter:[],yearFilter:e,showInfoWindow:null})}},{key:"setInfoWindow",value:function(e){this.setState({showInfoWindow:e})}},{key:"pollFilter",value:function(e){var t=this;q.a.get(O+"/filter?username="+e).then(function(n){if(console.log(n),n.data&&n.data.docs&&n.data.docs.length){var r=t.state.projectionId?[]:[e];n.data.docs[0].filter.forEach(function(e){r.push(e)}),t.setUserFilter(r)}}).catch(function(e){console.log(e)})}},{key:"handleFilterClose",value:function(){console.log("handleFilterClose"),q.a.get(O+"/remove_filter/"+(this.state.projectionId?this.state.projectionId:this.state.mcmmId)).then(function(e){console.log(e)}).catch(function(e){console.log(e)}),this.setUserFilter([]),this.setMusicianFilter(null),this.setYearFilter(null)}},{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,r,i,a,o=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.a.get(O+"/translation");case 2:t=e.sent,this.setState({translations:t.data.docs}),n=null,URLSearchParams&&(r=new URLSearchParams(window.location.search),n=r.get("projection_id")),n?(this.setState({projectionId:n}),this.pollInterval=setInterval(function(){o.pollFilter(n)},5e3)):(i=window.location.hash,a=localStorage.getItem("mcmmId"),i&&(a=i.substr(1),this.setState({currentPage:"list",mcmmId:a,menuOpen:!0,navStack:["home"]})),a||(a=Tt()),this.setState({mcmmId:a}),localStorage.setItem("mcmmId",a)),Object(b.disableBodyScroll)(document.querySelector("body"));case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearInterval(this.pollInterval)}},{key:"render",value:function(){var e=this,t=this.state.userFilter.length>0||this.state.musicianFilter||this.state.yearFilter,n={home:i.a.createElement(Ze,{mcmmId:this.state.mcmmId,userFilter:this.state.userFilter,setUserFilter:this.setUserFilter,musicianFilter:this.state.musicianFilter,setMusicianFilter:this.setMusicianFilter,yearFilter:this.state.yearFilter,setYearFilter:this.setYearFilter,largeScreen:this.state.largeScreen,translations:this.state.translations,locale:this.state.locale,setInfoWindow:this.setInfoWindow,showInfoWindow:this.state.showInfoWindow}),list:i.a.createElement(Te,{mcmmId:this.state.mcmmId,editEntry:function(t){e.navigate("edit",t)},translations:this.state.translations,locale:this.state.locale,setUserFilter:this.setUserFilter,titleKey:"my_entries",navigate:this.navigate}),edit:i.a.createElement(at,{mcmmId:this.state.mcmmId,back:this.back,entry:this.state.currentEntry,translations:this.state.translations,locale:this.state.locale,titleKey:this.state.currentEntry?"update entry":"new entry"}),scan:i.a.createElement(gt,{mcmmId:this.state.mcmmId,setUserFilter:this.setUserFilter,translations:this.state.translations,locale:this.state.locale,pollFilter:this.pollFilter,titleKey:"scanner"}),page:i.a.createElement(jt,{translations:this.state.translations,locale:this.state.locale,pageKey:this.state.pageKey,titleKey:this.state.pageKey+"_heading"})},r=n.home,a="home"!==this.state.currentPage?n[this.state.currentPage]:null;return[i.a.createElement(Nt,{key:"globalstyles"}),i.a.createElement(v.a,{key:"resize",handleWidth:!0,handleHeight:!0,onResize:this.onResize}),i.a.createElement(R,{menuOpen:this.state.menuOpen,key:"menu",close:this.toggleMenu,navigate:this.navigate,translations:this.state.translations,locale:this.state.locale,setLocale:this.setLocale,reset:this.reset,projectionMode:!!this.state.projectionId,render:a}),i.a.createElement(Wt,{key:"main"},i.a.createElement(Ft,null),!t&&i.a.createElement(zt,null,i.a.createElement(Lt,{onClick:this.toggleMenu,src:"images/menu.png"}),i.a.createElement(Dt,null,"MATCH CUT")),t&&i.a.createElement(S,{onClose:this.handleFilterClose,menuOpen:this.state.menuOpen},this.state.userFilter.length>0&&i.a.createElement("span",null,w(this.state.translations,"filter_for",this.state.locale),"\xa0",this.state.userFilter.length,"\xa0",this.state.userFilter.length>1?w(this.state.translations,"users",this.state.locale):w(this.state.translations,"user",this.state.locale)),this.state.musicianFilter&&i.a.createElement("span",null,w(this.state.translations,"filter_for",this.state.locale)," ",w(this.state.translations,"users_that_named",this.state.locale)," ",F(this.state.musicianFilter)),this.state.yearFilter&&i.a.createElement("span",null,w(this.state.translations,"filter_for",this.state.locale)," ",w(this.state.translations,"entries_from_year",this.state.locale)," ",this.state.yearFilter)),r,("home"===this.state.currentPage&&!t||"list"==this.state.currentPage)&&i.a.createElement(Ut,{onClick:function(){return e.navigate("edit")},largeScreen:this.state.largeScreen},"+"))]}}]),t}(r.Component),zt=g.b.div(_t()),Dt=g.b.span(Ct()),Lt=g.b.img(St()),Wt=g.b.div(It()),Ut=g.b.div(Et(),function(e){return e.largeScreen?"9rem":"2rem"}),Nt=Object(g.a)(xt()),Pt=function(){return i.a.createElement(Mt,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Pt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[50,1,2]]]);
//# sourceMappingURL=main.270b0a6a.chunk.js.map