(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{41:function(e,t,n){e.exports=n(74)},46:function(e,t,n){},70:function(e){e.exports=[{elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}]},74:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),o=n.n(i),s=(n(46),n(2)),c=n(4),l=n(5),u=n(7),m=n(6),p=n(8),h=(n(47),n(1));function f(){var e=Object(s.a)(["\n  position: fixed;\n  top: 0; left: 0;\n  margin-top: 20px;\n  padding: 20px;\n"]);return f=function(){return e},e}function d(){var e=Object(s.a)(["\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  width: 30px;\n  height: 30px;\n  &:hover {cursor: pointer};\n"]);return d=function(){return e},e}function y(){var e=Object(s.a)(["\n  margin-bottom: 10px;\n  &:hover {cursor: pointer};\n"]);return y=function(){return e},e}n(23);var b=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(x,null,r.a.createElement(g,{onClick:function(){return e.props.navigate("home")}},"home"),r.a.createElement(g,{onClick:function(){return e.props.navigate("list")}},"my entries"),r.a.createElement(v,{src:"/images/close.png",onClick:this.props.close}))}}]),t}(a.Component),g=h.b.li(y()),v=h.b.img(d()),x=h.b.ul(f()),k=n(12),w=n.n(k),O=n(15),j=n(10),E=n.n(j),T="/api",C=n(11);function S(){var e=Object(s.a)(["\n  width: 100%; \n  height: 100%;\n  visibility: ","\n"]);return S=function(){return e},e}var _=n(70),I=window.google,M=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).mapContainerRef=r.a.createRef(),n.markers=[],n.lines=[],n.infoWindows=[],n.state={entries:[]},n.fetchData=n.fetchData.bind(Object(C.a)(n)),n.drawMap=n.drawMap.bind(Object(C.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"fetchData",value:function(){var e=this;E.a.get(T+"/map_entries/"+(this.props.musicianFilter?"?musician="+this.props.musicianFilter:"")).then(function(t){console.log(t),e.setState({entries:t.data},e.drawMap)}).catch(function(e){console.log(e)})}},{key:"componentDidMount",value:function(){this.fetchData(),this.map=new I.maps.Map(this.mapContainerRef.current,{zoom:1,center:{lat:0,lng:0},streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1,styles:_})}},{key:"componentDidUpdate",value:function(e){this.props.musicianFilter!==e.musicianFilter&&(this.markers.forEach(function(e){e.setMap(null)}),this.markers=[],this.entries=[],this.fetchData())}},{key:"drawMap",value:function(){var e=this,t={url:"/images/marker.svg",scaledSize:{height:30,width:30},origin:{x:0,y:0},anchor:{x:12.5,y:12.5},labelOrigin:new I.maps.Point(12.5,12.5)},n=new window.google.maps.LatLngBounds;Object.keys(this.state.entries).forEach(function(a){var r=e.state.entries[a][0],i=new I.maps.Marker({position:r.cityLocation,icon:t,map:e.map}),o=r.city+"<br>";e.state.entries[a].forEach(function(e){o+=e.musician+" "+e.year+"<br>"});var s=new I.maps.InfoWindow({content:o});i.addListener("click",function(){s.open(this.map,i)}),e.markers.push(i),e.infoWindows.push(s),n.extend(r.cityLocation)}),this.lines.forEach(function(t){return t.setMap(e.map)}),this.map.fitBounds(n)}},{key:"render",value:function(){return r.a.createElement(F,{ref:this.mapContainerRef})}}]),t}(a.Component),F=h.b.div(S(),function(e){return 0!=e.visible?"visible":"hidden"});function D(){var e=Object(s.a)(["\n  display: inline-block;\n  background-image: url(/images/dot.png);\n  width: 20px;\n  height: 20px;\n  background-repeat: no-repeat;\n  background-size: contain;\n  color: #fff;\n  font-size: 12px;\n  text-align: center;\n  line-height: 20px;\n"]);return D=function(){return e},e}function z(){var e=Object(s.a)(["\n  list-style: none;\n  margin-left: 0px;\n"]);return z=function(){return e},e}function L(){var e=Object(s.a)(["\n  padding-left: 0px;\n"]);return L=function(){return e},e}function P(){var e=Object(s.a)(["\n  color: orange;\n  margin-left: 5px;\n  :hover {cursor: pointer};\n"]);return P=function(){return e},e}var R=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={entries:[]};var a=["\ud83d\udc36","\ud83d\udc31","\ud83d\udc2d","\ud83d\udc39","\ud83d\udc30","\ud83e\udd8a","\ud83e\udd9d"];return n.user_emoji=a[Math.floor(Math.random()*a.length)],n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t=this;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.hash=this.props.mcmmId,E.a.get(T+"/entry_by_user/"+this.props.mcmmId+"/").then(function(e){t.setState({entries:e.data.docs})}).catch(function(e){console.log(e)});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.entries.map(function(t,n){return r.a.createElement(W,{key:n},e.user_emoji," ",t.musician," ",t.city," ",t.year," ",r.a.createElement(N,{onClick:function(){e.props.editEntry(t)}},"[edit]"))});return r.a.createElement("div",null,r.a.createElement("h1",null,"my entries"),r.a.createElement(B,null,t),r.a.createElement("p",null,"This is your secret edit link: ",r.a.createElement("a",{href:"#"+this.props.mcmmId},"#"+this.props.mcmmId)),r.a.createElement("p",null,"Bookmark it to manage your entries later or from other devices. If you lose it, you might lose access to your entries."),r.a.createElement(M,{entries:[{entries:this.state.entries}]}))}}]),t}(a.Component),N=h.b.span(P()),B=h.b.ul(L()),W=h.b.li(z()),A=(h.b.span(D()),n(37)),V=n(21);function G(){var e=Object(s.a)(['\n  position: fixed;\n  bottom:0;\n  left:0;\n  right: 0;\n  padding: 1rem;\n  box-sizing: border-box;\n\n  display: flex;\n  width: 100%;\n\n  li {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    height: 6em;\n  }\n\n  li .year_top {\n    height: 3vh;\n    /* background: red; */\n  }\n\n  li .year_top img {\n    width: auto;\n    height: 1vh;\n    /* background: yellow; */\n  }\n\n  li .year_middle {\n    height: 3vh;\n  }\n\n  li .year_middle:before {\n    content: "";\n    border: solid 1px black;\n    border-width: 0 0 0 1px;\n    position: relative;\n    left: calc(50% - 1px);\n  }\n\n  li .year_bottom {\n    height: 3vh;\n    /* background: green; */\n  }\n\n  li .year_bottom span {\n    width: calc(1em + 20%);\n    transform: rotate(-90deg) translateX(-100%);\n    overflow: visible;\n    /* background: red; */\n  }\n\n  li > * {\n    position: relative;\n  }\n\n  li > * > * {\n    position: absolute;\n  }\n']);return G=function(){return e},e}var J=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={data:[]},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get(T+"/year_data/").then(function(t){console.log("yearly data loaded"),e.setState({data:t.data})}).catch(function(e){console.log(e)})}},{key:"renderYear",value:function(e,t){return r.a.createElement("li",{key:e},r.a.createElement("span",{className:"year_top"},t>0?r.a.createElement("img",{style:{transform:"scale("+t+")"},alt:e,src:"/images/marker.svg"}):null),r.a.createElement("span",{className:"year_middle"}),r.a.createElement("span",{className:"year_bottom"},r.a.createElement("span",null,t>0?e:null)))}},{key:"render",value:function(){var e=this,t=this.state.data;if(!t||0===t.length)return null;t.unshift.apply(t,Object(V.a)(Array.from(Array(4),function(e,n){return{year:n+(t[0].year-4),amount:0}})));t.push.apply(t,Object(V.a)(Array.from(Array(1),function(e,n){return{year:n+(t[t.length-1].year+1),amount:0}})));var n=t[0].year,a=t.map(function(t){return e.renderYear(t.year,t.amount)});return r.a.createElement(U,{start:n},a)}}]),t}(a.PureComponent),U=h.b.ol(G());function Y(){var e=Object(s.a)(["\n  &:hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n"]);return Y=function(){return e},e}function q(){var e=Object(s.a)(["\n  position: fixed;\n  right: 0;\n  top: 0;\n  width: 33vw;\n  padding: 1rem 1rem 0 0;\n  box-sizing: border-box;\n\n  ul {\n    list-style-type: none;\n  } ;\n  li {\n    display: flex;\n    span:first-child {\n      width: 2em;\n    }\n    span:last-child {\n      flex: 1;\n      &:hover {\n        cursor: pointer;\n        text-decoration: underline;\n      }\n    }\n  }\n"]);return q=function(){return e},e}var H=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={musicians:[]},n.fetchData=n.fetchData.bind(Object(C.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this;E.a.get(T+"/top_musicians/10/"+(this.props.musicianFilter?"?musician="+this.props.musicianFilter:"")).then(function(t){console.log(t.data),e.setState({musicians:t.data})}).catch(function(e){console.log(e)})}},{key:"componentDidUpdate",value:function(e){this.props.musicianFilter!==e.musicianFilter&&this.fetchData()}},{key:"render",value:function(){var e=this,t=this.state.musicians.map(function(t,n){return r.a.createElement("li",{key:n,onClick:function(){return e.props.setMusicianFilter(t.name)}},r.a.createElement("span",null,t.percent,"%"),"\xa0",r.a.createElement("span",null,t.name,"\xa0(",t.count,")"))});return r.a.createElement(X,null,this.props.musicianFilter&&r.a.createElement("p",null,"filter: ",this.props.musicianFilter,r.a.createElement($,{onClick:function(){return e.props.setMusicianFilter(null)}},"clear")),r.a.createElement("ul",null,t))}}]),t}(a.Component),X=h.b.div(q()),$=h.b.span(Y());function K(){var e=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n"]);return K=function(){return e},e}var Q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).onResize=function(e,t){n.setState({showTopMusiciansList:e>600,showLineGraph:e>600})},n.state={musicianFilter:null,userFiler:[]},n.setMusicianFilter=n.setMusicianFilter.bind(Object(C.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setMusicianFilter",value:function(e){this.setState({musicianFilter:e,userFilter:[]})}},{key:"render",value:function(){return r.a.createElement(Z,null,r.a.createElement(M,{musicianFilter:this.state.musicianFilter}),this.state.showTopMusiciansList&&r.a.createElement(H,{setMusicianFilter:this.setMusicianFilter,musicianFilter:this.state.musicianFilter}),this.state.showLineGraph&&r.a.createElement(J,null),r.a.createElement(A.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}}]),t}(a.Component),Z=h.b.div(K()),ee=n(19),te=n(20),ne=n.n(te);function ae(){var e=Object(s.a)(["\n  width: 100%;\n  margin-top: 20px;\n  :hover {cursor: pointer};\n  text-align: center;\n"]);return ae=function(){return e},e}function re(){var e=Object(s.a)(["\n  width: 100%;\n  height: 100px;\n  padding: 10px;\n  font-size: 150%;\n  box-sizing: border-box;\n"]);return re=function(){return e},e}function ie(){var e=Object(s.a)(["\n  font-size: 200%;\n  text-align: left;\n  width: 100%;\n  height: 2em;\n  box-sizing: border-box;\n"]);return ie=function(){return e},e}function oe(){var e=Object(s.a)(["\n  display: inline-block;\n  width: 200px;\n  margin-top: 10px;\n  margin-bottom: 5px;\n"]);return oe=function(){return e},e}var se=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleSubmit=function(e){console.log(n.state),n.state._id?E.a.put(T+"/entry/"+n.state._id,{musician:n.state.musician,city:n.state.city,year:parseInt(n.state.year),note:n.state.note,user_id:n.props.mcmmId}).then(function(e){console.log(e),n.setState({_id:e.data._id,changed:!1})}).catch(function(e){console.log(e)}):E.a.post(T+"/entry",{musician:n.state.musician,city:n.state.city,year:parseInt(n.state.year),note:n.state.note,user_id:n.props.mcmmId}).then(function(e){console.log(e),n.setState({_id:e.data._id,changed:!1})}).catch(function(e){console.log(e)})},n.handleDelete=function(){window.confirm("really?")&&E.a.delete(T+"/entry/"+n.state._id,{}).then(function(e){console.log(e),n.props.back()}).catch(function(e){console.log(e)})},n.handleInputChange=function(e){var t,a=e.target,r=a.name,i="year"!=r||"year"==r&&!isNaN(a.value)?a.value:n.state.year;n.setState((t={},Object(ee.a)(t,r,i),Object(ee.a)(t,"changed",!0),t))},n.state={musician:n.props.entry?n.props.entry.musician:"",city:n.props.entry?n.props.entry.city:"",year:n.props.entry?n.props.entry.year:"",note:n.props.entry?n.props.entry.note:"",_id:n.props.entry?n.props.entry._id:null,musicians:[],cities:[],changed:!1},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t=this;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:E.a.get(T+"/entry_uniques/").then(function(e){console.log(e),t.setState({musicians:e.data.musicians}),t.setState({cities:e.data.cities})}).catch(function(e){console.log(e)});case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("h1",null,this.state._id?"update entry":"new entry"),r.a.createElement("form",null,r.a.createElement(ce,null,"musician/composer/band"),r.a.createElement(ne.a,{items:this.state.musicians.map(function(e){return{value:e}}),getItemValue:function(e){return e.value},shouldItemRender:function(e,t){return e.value.toLowerCase().indexOf(t.toLowerCase())>-1},renderItem:function(e,t){return r.a.createElement("div",{key:e.value,style:{backgroundColor:t?"#eee":"transparent"}},e.value)},value:this.state.musician,onChange:function(t){return e.setState({musician:t.target.value,changed:!0})},onSelect:function(t){return e.setState({musician:t,changed:!0})},wrapperStyle:{display:"block"},inputProps:{style:le}}),r.a.createElement("br",null),r.a.createElement(ce,null,"city"),r.a.createElement(ne.a,{items:this.state.cities.map(function(e){return{value:e}}),getItemValue:function(e){return e.value},shouldItemRender:function(e,t){return e.value.toLowerCase().indexOf(t.toLowerCase())>-1},renderItem:function(e,t){return r.a.createElement("div",{key:e.value,style:{backgroundColor:t?"#eee":"transparent"}},e.value)},value:this.state.city,onChange:function(t){return e.setState({city:t.target.value,changed:!0})},onSelect:function(t){return e.setState({city:t,changed:!0})},wrapperStyle:{display:"block"},inputProps:{style:le}}),r.a.createElement("br",null),r.a.createElement(ce,null,"year"),r.a.createElement(ue,{autoComplete:"off",type:"text",name:"year",value:this.state.year,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement(ce,null,"note"),r.a.createElement(me,{name:"note",value:this.state.note,onChange:this.handleInputChange}),r.a.createElement("br",null),this.state.changed&&r.a.createElement(pe,{onClick:this.handleSubmit},"save"),this.state._id&&r.a.createElement(pe,{onClick:this.handleDelete},"delete entry")))}}]),t}(a.Component),ce=h.b.label(oe()),le={width:"100%",height:"2em",fontSize:"200%",boxSizing:"border-box"},ue=h.b.input(ie()),me=h.b.textarea(re()),pe=h.b.div(ae());function he(){var e=Object(s.a)(["\n\n  @font-face {\n    font-family: NeutraText;\n    src:  url('/fonts/NeutraText-Bold.otf');\n    /*[unicode-range: <urange>#;]?\n    [font-variant: <font-variant>;]?\n    [font-feature-settings: normal|<feature-tag-value>#;]?\n    [font-stretch: <font-stretch>;]?\n    [font-weight: <weight>];\n    [font-style: <style>];*/\n  }\n\n  html, body, #root {\n    height: 100%;\n    width: 100%;\n  }\n\n  body {\n    font-family: NeutraText, sans-serif;\n  }\n"]);return he=function(){return e},e}function fe(){var e=Object(s.a)(["\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  width: 30px;\n  height: 30px;\n  &:hover {cursor: pointer};\n"]);return fe=function(){return e},e}function de(){var e=Object(s.a)(["\n  position: fixed;\n  z-index: 100;\n  right: 20px;\n  bottom: 20px;\n  border: 1px solid black;\n  background-color: white;\n  padding: 10px;\n  :hover {cursor: pointer}; \n"]);return de=function(){return e},e}function ye(){var e=Object(s.a)(["\n  height: 100%;\n  width: 100%;\n  background: red;\n"]);return ye=function(){return e},e}function be(){var e=Object(s.a)(["\n  position: fixed;\n  z-index: 100;\n  width: 30px;\n  height: 30px;\n  left: 10px;\n  top: 10px;\n  :hover {cursor: pointer}; \n"]);return be=function(){return e},e}var ge=n(23),ve=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).toggleMenu=function(){n.setState({menuOpen:!n.state.menuOpen})},n.navigate=function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){var a=n.state.navStack;a.push(n.state.currentPage),console.log(a),n.setState({navStack:a})}n.setState({menuOpen:!1,currentPage:e,currentEntry:t}),"list"!=e&&window.history.pushState("",document.title,window.location.pathname)},n.back=function(){var e=n.state.navStack,t=e.pop();n.setState({navStack:e}),n.navigate(t,n.state.entry,!0)},n.state={examples:[],menuOpen:!1,currentPage:"home",mcmmId:null,navStack:[]},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=window.location.hash,t=localStorage.getItem("mcmmId");e&&(t=e.substr(1),this.setState({currentPage:"list",mcmmId:t,navStack:["home"]})),t||(t=ge()),this.setState({mcmmId:t}),localStorage.setItem("mcmmId",t)}},{key:"render",value:function(){var e=this,t={home:r.a.createElement(Q,null),list:r.a.createElement(R,{mcmmId:this.state.mcmmId,editEntry:function(t){e.navigate("edit",t)}}),edit:r.a.createElement(se,{mcmmId:this.state.mcmmId,back:this.back,entry:this.state.currentEntry})}[this.state.currentPage];return this.state.menuOpen?r.a.createElement(b,{close:this.toggleMenu,navigate:this.navigate}):r.a.createElement(ke,null,r.a.createElement(je,null),r.a.createElement(xe,{onClick:this.toggleMenu,src:"images/menu.png"}),t,("home"===this.state.currentPage||"list"==this.state.currentPage)&&r.a.createElement(we,{onClick:function(){return e.navigate("edit")}},"add"),"home"!==this.state.currentPage&&r.a.createElement(Oe,{src:"/images/close.png",onClick:this.back}))}}]),t}(a.Component),xe=h.b.img(be()),ke=h.b.div(ye()),we=h.b.div(de()),Oe=h.b.img(fe()),je=Object(h.a)(he()),Ee=function(){return r.a.createElement(ve,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[41,1,2]]]);
//# sourceMappingURL=main.92d71206.chunk.js.map